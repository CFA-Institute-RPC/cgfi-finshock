(function(){"use strict";function d(e,n){let t=0;for(let s=0;s<e[n].length;s++)t+=e[n][s];return t}function k(e,n){let t=0;for(let s=0;s<e.length;s++)t+=e[s][n];return t}const C=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];function W(e){let n=C.length-1,t=!1,s=0,f=0,l,i,r,o;for(e<0&&(e=-e,t=!0),l=2/(2+e),i=4*l-2;n>0;n--)r=s,s=i*s-f+C[n],f=r;return o=l*Math.exp(-e*e+.5*(C[0]+i*s)-f),t?o-1:1-o}function D(e){return .5*(1+W(e/Math.sqrt(2)))}const _=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];function F(e){let n=0,t=1.000000000190015,s,f,l;for(l=(f=s=e)+5.5,l-=(s+.5)*Math.log(l);n<6;n++)t+=_[n]/++f;return Math.log(2.5066282746310007*t/s)-l}function b(e,n,t){let s=1e-30,f=1,l=n+t,i=n+1,r=n-1,o=1,a=1-l*e/i,c,g,p,h;for(Math.abs(a)<s&&(a=s),a=1/a,h=a;f<=100&&(c=2*f,g=f*(t-f)*e/((r+c)*(n+c)),a=1+g*a,Math.abs(a)<s&&(a=s),o=1+g/o,Math.abs(o)<s&&(o=s),a=1/a,h*=a*o,g=-(n+f)*(l+f)*e/((n+c)*(i+c)),a=1+g*a,Math.abs(a)<s&&(a=s),o=1+g/o,Math.abs(o)<s&&(o=s),a=1/a,p=a*o,h*=p,!(Math.abs(p-1)<3e-7));f++);return h}function N(e,n,t){let s=e===0||e===1?0:Math.exp(F(n+t)-F(n)-F(t)+n*Math.log(e)+t*Math.log(1-e));if(e<0||e>1)throw new Error("Argument x must be between 0 and 1.");return e<(n+1)/(n+t+2)?s*b(e,n,t)/n:1-s*b(1-e,t,n)/t}function U(e,n,t){return e>1?1:e<0?0:N(e,n,t)}function v(e,n,t,s,f,l,i){let r=new Array(t.length);for(let o=0;o<t.length;o++)r[o]=1+t[o]/(d(e,o)+n[o]),(!isFinite(r[o])||isNaN(r[o]))&&(r[o]=0),s[o]===0?r[o]=r[o]>=1?1:0:r[o]=(r[o]>=1+s[o]?1:0)+(r[o]>=1&&r[o]<1+s[o]?1-f*U((1+s[o]-r[o])/s[o],l,i):0);return r}function A(e,n,t,s,f,l){const i=new Array(t.length);for(let r=0;r<t.length;r++)i[r]=t[r]/(e[r]-n[r]),i[r]>=1?i[r]=1:i[r]=1-s*(1-D((Math.log(1/(1-i[r]))-f*f*l/2)/(f*Math.sqrt(l))));return i}function j(e,n,t,s,f,l){const i=new Array(t.length);for(let r=0;r<t.length;r++){const o=t[r]/(e[r]-n[r]);if(o>1)i[r]=1;else if(o>=0&&o<1){const a=D((Math.log(1/(1-o))-f*f*l/2)/(f*Math.sqrt(l))),c=1/(1-o)*D((-Math.log(1/(1-o))-f*f*l)/(f*Math.sqrt(l)));i[r]=1-s*(1-a+c)}else i[r]=1-s}return i}function m(e){const n=new Array(e.length);for(let t=0;t<e.length;t++)n[t]=e[t];return n}function Y(e,n,t,s,f,l,i,r,o,a,c){const g=[],p=[];let h=new Array(e.length);for(let u=0;u<e.length;u++)h[u]=e[u]+k(t,u)-d(t,u)-s[u];g.push(m(h));const E=new Array(t.length);let w;if(E.fill(1),p.push(E),l==="Distress"){let u=!1;for(let q of n)if(q!==0){u=!0;break}if(!u)return[g,p]}for(let u=0;u<e.length;u++)h[u]=e[u]-n[u]+k(t,u)-d(t,u)-s[u];g.push(m(h));let P=0;const S=5e3;let M=new Array(h.length);for(let u=0;u<h.length;u++)M[u]=1e9;let V=!0;for(;V&&P<S;){V=!1;for(let u=0;u<h.length;u++)if(Math.abs(h[u]-M[u])>1e-6){V=!0;break}if(M=m(h),l==="Distress")w=v(t,s,M,f,i,r,o);else if(l==="Merton")w=A(e,n,M,i,a,c);else if(l==="Black")w=j(e,n,M,i,a,c);else throw new Error("Unknown Type specified.");p.push(m(w)),h=new Array(h.length);for(let u=0;u<h.length;u++){let q=0,B=0;for(let y=0;y<t.length;y++)q+=t[y][u]*w[y],B+=t[u][y];h[u]=e[u]-n[u]+q-B-s[u]}g.push(m(h)),P++}if(M=m(h),l==="Distress")w=v(t,s,M,f,i,r,o);else if(l==="Merton")w=A(e,n,M,i,a,c);else if(l==="Black")w=j(e,n,M,i,a,c);else throw new Error("Unknown Type specified.");return p.push(m(w)),P>=S&&console.warn("Maximum iterations reached without convergence."),[g,p]}function $(e,n,t){const s=new Array(e.length);for(let f=0;f<e.length;f++)s[f]=e[f]+k(t,f)-d(t,f)-n[f];return s}function z(e,n,t,s,f="Distress",l=1,i=1,r=1,o=.5,a=5){const c=$(e,n,t),g=new Array(c.length);for(let p=0;p<c.length;p++)g[p]=c[p]/(d(t,p)+n[p]);return Y(e,s,t,n,g,f,l,i,r,o,a)}function G(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function H(e){return!!e&&(typeof e=="object"||typeof e=="function")&&typeof e.then=="function"}function J(e){function n(l,i,r,o){function a(c){typeof self.postMessage!="function"?l.ports[0].postMessage(c):self.postMessage(c)}r?(typeof console<"u"&&"error"in console&&console.error("Worker caught an error:",r),a([i,{message:r.message}])):a([i,null,o])}function t(l,i){try{return{res:l(i)}}catch(r){return{err:r}}}function s(l,i,r,o){var a=t(i,o);a.err?n(l,r,a.err):H(a.res)?a.res.then(function(c){n(l,r,null,c)},function(c){n(l,r,c)}):n(l,r,null,a.res)}function f(l){var i=l.data;if(!(!Array.isArray(i)||i.length!==2)){var r=i[0],o=i[1];typeof e!="function"?n(l,r,new Error("Please pass a function into register().")):s(l,e,r,o)}}self.addEventListener("message",f)}var K=J,Q=G(K);Q(e=>{const{extAssets:n,extLiabilities:t,liabilityMatrix:s,shock:f,valueFunc:l,R:i,alpha:r,beta:o,volatility:a,maturity:c}=e.message;return z(n,t,s,f,l,i,r,o,a,c)})})();
